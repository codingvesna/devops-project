# devops-project

Developed by ` vesna.milovanovic@endava.com `

**Tech Stack**
- Java
- Maven
- AWS
- Docker
- Terraform
- Ansible
- Jenkins
- Git

---

## Part 1 - Java Web App with Unit Tests 

Source Code: https://github.com/codingvesna/devops-project/tree/java-web-app

App Deployed to AWS EBS: http://java-web-app.eu-west-1.elasticbeanstalk.com/

Or run on local machine:

 - Clone repo, start Tomcat Server, open port 8081 and go to browser ` http://localhost:8081/java-web-app/ `

### App Description

A Simple Web App built with Java & Maven.

**Test Cases:**

- Test Register Page - index.jsp
- Test Login page - home.jsp

### Prerequisities for App Development

- Java 17.0.1
- JWebUnit - Framework used with JUnit to test the web application.
- Apache Tomcat 9.0.56
- Apache Maven 3.8.4
- AWS Elastic Beanstalk (deployment)
- IntelliJ IDEA - IDE for app development

---

## Part 2 - Infrastructure & Configuration

### Providing infrastructure with Terraform

Scripts location: https://github.com/codingvesna/devops-project branch: `main` folder: `scripts`

### Prerequisites
1. Installed **AWS CLI**
2. Created IAM user *vesna*, generated *AWS Access Key ID & Secret Access Key*
3. Used `aws configure` command to input credentials (also can be set under the *provider* block)
4. Created **main.tf** to define the architecture


### Building Infrastructure

The **terraform** block - Terraform setup, listed required providers, in this case aws; 

The **provider** block - provider definition, *profile* - reference to the AWS credentials stored in AWS config file (access keys generated by the AWS IAM for the user *vesna*);

The **resource** block - used aws_instance as a resource type and devops_project as the resource name, so **aws_instance.devops_project** is a unique ID for the resource; 
ami refers to the *Ubuntu AMI* used in this case, created t2.micro instance with the name *DevOpsProject* 

1. `terraform init` download & install providers **REQUIRED**
2. `terraform fmt` print out the names of the modified files
3. `terraform validate` check syntax
4. `terraform apply` create the infrastructure **REQUIRED**
5. `terraform show` inspect the current state

What's defined in `main.tf`?

- create ec2 instance
- create s3 bucket for remote state
- create s3 bucket policy
- create key pair
- create security group - allow traffic on ports 22, 8080, 8081
- connect via SSH to remote instance 
- trigger ansible playbook

**Connect to EC2 via SSH --> main.tf**

1. Added variables **PATH_TO_PRIVATE_KEY** & **PATH_TO_PUBLIC_KEY**
2. Used ec2 resource **aws_key_pair** to control login access to ec2 instances &
3. file function to read the public ssh key from a file 

### Congifuration with Ansible

What's defined in `config.yml`?

- JDK, JRE
- Maven
- Jenkins
- Firewalld

---

### Other

- EC2 Ubuntu Instance ` terraform-controller ` that is as a control node for Terraform and Ansible.
- Bash scripts `install-ansible.yml` , `install-terraform.sh`, `update.sh` - to install Terraform and Ansible on control node

